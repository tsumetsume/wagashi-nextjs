# 和菓子詰め合わせシミュレーター 詳細操作ガイド

## 📋 目次
- [🎯 システム概要](#システム概要)
- [🚀 はじめに](#はじめに)
- [💻 画面構成](#画面構成)
- [📝 基本操作手順](#基本操作手順)
- [⚙️ 高度な機能](#高度な機能)
- [💾 データ管理](#データ管理)
- [🖨️ 印刷機能](#印刷機能)
- [🔧 トラブルシューティング](#トラブルシューティング)
- [❓ FAQ](#faq)

---

## 🎯 システム概要

和菓子詰め合わせシミュレーターは、お客様が理想の和菓子詰め合わせを視覚的にデザインできるWebアプリケーションです。

### 🌟 主要機能
- **ドラッグ＆ドロップ操作**: 直感的な和菓子配置
- **リアルタイム価格計算**: 配置と同時に合計金額を表示
- **仕切り自動配置**: AIによる最適な仕切り配置
- **カスタマーコード**: 8文字コードでレイアウト保存・復元
- **高品質印刷**: 美しい印刷レイアウトで出力
- **在庫管理連携**: リアルタイム在庫状況表示

---

## 🚀 はじめに

### システム起動方法

#### Docker環境での起動
```bash
# アプリケーションコンテナでコマンド実行
docker compose exec app npm run dev

# または直接アクセス
# http://localhost:3000
```

#### 初回アクセス時の流れ
1. ブラウザで `http://localhost:3000` にアクセス
2. 店舗選択画面が表示される
3. 対象店舗を選択
4. シミュレーター画面に移動

### 🎓 チュートリアル機能

初回利用時は、画面右上の「チュートリアル」ボタンをクリックして、ガイド付きで操作方法を学習できます。

**チュートリアルの流れ:**
1. ようこそ画面
2. 和菓子選択方法
3. ドラッグ＆ドロップ操作
4. コンテキストメニュー
5. 商品情報表示
6. 設定カスタマイズ
7. 保存・読み込み
8. カスタマーコード保存
9. 仕切り自動配置
10. 印刷機能
11. 完了

---

## 💻 画面構成

### ヘッダーエリア
```
[和菓子詰め合わせシミュレーター] [箱サイズ▼] [新規] [保存] [読込] [コード保存] [在庫] [⚙️] [?] [📖]
```

| ボタン | 機能 | 説明 |
|--------|------|------|
| 箱サイズ | サイズ選択 | 10×10、15×15、20×20から選択 |
| 新規 | リセット | 現在の配置をクリア |
| 保存 | ローカル保存 | JSONファイルでダウンロード |
| 読込 | ローカル読込 | JSONファイルから復元 |
| コード保存 | クラウド保存 | 8文字コードで保存 |
| 在庫 | 在庫管理 | 在庫状況の確認・更新 |
| ⚙️ | 設定 | 表示項目のカスタマイズ |
| ? | ヘルプ | 操作方法の確認 |
| 📖 | チュートリアル | ガイド付き操作説明 |

### メインエリア

#### 左側：箱エリア（配置エリア）
- **グリッド表示**: 和菓子配置用のマス目
- **価格表示**: 下部に合計金額を表示
- **操作ボタン**: 仕切り自動配置、印刷ボタン

#### 右側：選択エリア
- **カテゴリタブ**: 和菓子の種類別タブ
- **商品一覧**: 各カテゴリの和菓子表示
- **在庫状況**: 在庫あり/なしの表示

---

## 📝 基本操作手順

### Step 1: 箱サイズの選択

```bash
# 箱サイズの選択肢
10×10 → 小さめの詰め合わせ（1-4個程度）
15×15 → 中サイズの詰め合わせ（5-10個程度）
20×20 → 大きめの詰め合わせ（10個以上）
```

**操作方法:**
1. ヘッダー左上のドロップダウンをクリック
2. 希望するサイズを選択
3. 箱エリアのグリッドサイズが変更される

### Step 2: 和菓子の選択

**カテゴリ一覧:**
- 🍘 **焼き菓子**: どら焼き、カステラ、せんべい等
- 🍡 **餅菓子**: 大福、桜餅、草餅等
- 🍧 **水菓子**: あんみつ、ところてん、みつまめ等
- 🍯 **干菓子**: 金平糖、落雁等
- 🥟 **蒸し菓子**: 蒸しまんじゅう等
- 🌸 **季節限定**: 季節の和菓子
- 🏮 **伝統菓子**: 伝統的な和菓子
- ➖ **仕切り**: 詰め合わせ用仕切り

**操作方法:**
1. 右側のタブから希望カテゴリをクリック
2. 商品一覧から和菓子を確認
3. 在庫状況を確認（在庫切れは赤字表示）

### Step 3: 和菓子の配置

**ドラッグ＆ドロップ操作:**
1. 右側の和菓子をクリック＆ホールド
2. 左側の箱エリアまでドラッグ
3. 希望位置でドロップ
4. 緑色のプレビューが表示されれば配置可能
5. 赤色のプレビューは配置不可

**配置ルール:**
- 他の和菓子と重複不可
- 箱の範囲外への配置不可
- 仕切りとの交差不可

### Step 4: 配置後の編集

**移動操作:**
```bash
# マウス操作
ドラッグ＆ドロップで移動

# キーボード操作
矢印キー（↑↓←→）で1マスずつ移動
```

**回転操作:**
1. 和菓子を右クリック
2. 「回転」を選択
3. 90度ずつ回転（0°→90°→180°→270°→0°）

**削除操作:**
- 右クリック → 「削除」
- または Deleteキー

---

## ⚙️ 高度な機能

### 🔒 ロック機能

**用途:** 配置が決まった和菓子の位置を固定

**操作方法:**
1. 和菓子を右クリック
2. 「ロック」を選択
3. ロックされた和菓子は移動不可（🔒アイコン表示）
4. 解除は右クリック → 「アンロック」

### 📊 商品情報表示

**表示方法:**
- **ダブルクリック**: 和菓子をダブルクリック
- **右クリックメニュー**: 右クリック → 「商品情報」

**表示内容:**
```
商品名: 栗饅頭
価格: ¥250
サイズ: 2×2
カテゴリ: 餅菓子
原材料: 小麦粉、砂糖、栗、卵...
アレルギー: 小麦、卵、乳
カロリー: 180kcal
賞味期限: 製造日より3日
```

**画像拡大機能:**
- 商品情報内の画像をクリック
- 拡大表示でズーム操作可能
- マウスホイールでズームイン/アウト

### 🎛️ 表示設定カスタマイズ

**アクセス方法:** ヘッダーの⚙️ボタンをクリック

**設定項目:**
- ☑️ 商品名を表示
- ☑️ 価格を表示  
- ☑️ サイズを表示
- ☑️ 画像を表示
- ☑️ カテゴリを表示

**設定の保存:** 設定は自動保存され、次回アクセス時も維持

### ➖ 仕切り機能

#### 手動配置
1. 右側の「仕切り」タブを選択
2. 水平仕切りまたは垂直仕切りを選択
3. ドラッグ＆ドロップで配置
4. 右クリック → 「長さ調整」で長さ変更

#### 自動配置
1. 和菓子を配置完了
2. 「仕切り自動配置」ボタンをクリック
3. AIが最適な仕切り配置を計算
4. 和菓子間に自動で仕切りを配置

**自動配置のアルゴリズム:**
- 和菓子間の距離を計算
- 最適な仕切り位置を決定
- 和菓子に接触する位置にも配置
- 重複や交差を回避

---

## 💾 データ管理

### 💽 ローカル保存（JSONファイル）

**保存操作:**
```bash
# 保存ボタンクリック
→ ファイル名入力ダイアログ
→ 「wagashi_layout_YYYYMMDD.json」で保存
```

**保存内容:**
```json
{
  "version": "1.0.0",
  "boxSize": "15x15",
  "placedItems": [...],
  "displaySettings": {...},
  "createdAt": "2024-01-15T10:30:00Z",
  "totalPrice": 1250
}
```

**読み込み操作:**
1. 「読込」ボタンをクリック
2. JSONファイルを選択
3. 配置情報が復元される

### ☁️ カスタマーコード保存

**機能概要:**
- 8文字の英数字コードで詰め合わせを保存
- データベースに保存され、どの端末からでもアクセス可能
- 店舗での注文時にコードを伝えるだけで復元

**保存操作:**
```bash
# 前提条件: 和菓子が1つ以上配置されている
1. 「カスタマーコード保存」ボタンをクリック
2. 保存処理実行（数秒）
3. 8文字コード生成（例: AB12CD34）
4. コードをメモまたはスクリーンショット
```

**復元操作:**
```bash
# 店舗スタッフが実行
docker compose exec app npm run customer-code:load AB12CD34
```

**コードの有効期限:**
- 保存から1年間有効
- 期限切れ後は自動削除

### 📦 在庫管理連携

**在庫確認:**
1. ヘッダーの「在庫」ボタンをクリック
2. 全商品の在庫状況を表示
3. 在庫切れ商品は配置から自動削除

**在庫更新:**
```bash
# 管理者権限が必要
docker compose exec app npm run stock:update
```

---

## 🖨️ 印刷機能

### 📄 印刷設定

**アクセス:** 「印刷」ボタンをクリック

**基本設定:**
```
タイトル: [和菓子詰め合わせ] ← 編集可能
作成日: 2024年1月15日 ← 自動設定
```

**印刷オプション:**
- ☑️ **商品リストを含める**
  ```
  商品リスト
  ・栗饅頭 ¥250
  ・どら焼き ¥200
  ・桜餅 ¥180
  ```

- ☑️ **価格情報を含める**
  ```
  合計金額: ¥630
  ```

- ☑️ **アレルギー情報を含める**
  ```
  アレルギー情報
  [小麦] [卵] [乳] [大豆]
  ```

### 🎌 熨斗（のし）設定

**設定項目:**
```
☑️ 熨斗を含める
種類: [御祝 ▼] ← 御祝/御供/贈答/その他
上書き: [内祝] ← 表書き
下書き: [田中] ← 贈り主名
```

**熨斗デザイン:**
- 伝統的な和風デザイン
- 水引きのイラスト付き
- 美しい毛筆フォント

### 🖨️ 印刷実行

**手順:**
1. プレビューで確認
2. 「印刷」ボタンをクリック
3. ブラウザの印刷ダイアログが表示
4. プリンター選択
5. 用紙設定（推奨: A4）
6. 印刷実行

**印刷品質設定:**
```bash
# 推奨設定
用紙サイズ: A4
向き: 縦
余白: 標準
品質: 高品質
カラー: カラー印刷
```

---

## 🔧 トラブルシューティング

### ❌ よくあるエラーと解決方法

#### エラー1: 和菓子が配置できない
```
症状: ドロップしても和菓子が配置されない
原因: 配置先に障害物がある

解決方法:
1. 配置先に他の和菓子がないか確認
2. 仕切りと重なっていないか確認  
3. 箱の範囲内に配置しているか確認
4. 和菓子のサイズが配置先に収まるか確認
```

#### エラー2: 商品が表示されない
```
症状: 選択エリアに商品が表示されない
原因: データベース接続エラーまたは商品データなし

解決方法:
1. 右上の更新ボタン（🔄）をクリック
2. ページを再読み込み（F5）
3. 管理画面で商品データを確認
4. データベース接続を確認
```

#### エラー3: カスタマーコード保存エラー
```
症状: 「保存に失敗しました」エラー
原因: ネットワークエラーまたはサーバーエラー

解決方法:
1. インターネット接続を確認
2. しばらく待ってから再試行
3. 和菓子が配置されているか確認
4. ブラウザのキャッシュをクリア
```

#### エラー4: 印刷レイアウトが崩れる
```
症状: 印刷時にレイアウトが正しく表示されない
原因: ブラウザの印刷設定またはCSS読み込みエラー

解決方法:
1. 用紙サイズをA4に設定
2. 余白を「標準」に設定
3. 背景の印刷を有効にする
4. 別のブラウザで試行
```

### 🔄 システムリセット方法

**完全リセット:**
```bash
# 全データクリア
docker compose exec app npm run reset:all

# キャッシュクリア
docker compose exec app npm run cache:clear

# データベースリセット
docker compose exec app npm run db:reset
```

**部分リセット:**
```bash
# 配置データのみクリア
「新規」ボタンをクリック

# 設定のみリセット
⚙️ → 「デフォルトに戻す」
```

---

## ❓ FAQ

### 🤔 よくある質問

**Q1: 作成した詰め合わせを他の人と共有できますか？**
```
A1: はい、以下の方法で共有できます：
- JSONファイルをメール等で送信
- カスタマーコードを伝える（8文字）
- 印刷物を渡す
```

**Q2: 在庫切れの商品を配置するとどうなりますか？**
```
A2: 在庫切れ商品の動作：
- 選択エリアで赤字表示
- 配置は可能だが警告表示
- 印刷時に「在庫切れ」注記
- 注文時に代替商品を提案
```

**Q3: 箱サイズを途中で変更できますか？**
```
A3: はい、変更可能です：
- ヘッダーのドロップダウンで変更
- 配置済み和菓子は保持される
- 範囲外の和菓子は自動削除される
- 変更前に保存を推奨
```

**Q4: 同じ和菓子を複数個配置できますか？**
```
A4: はい、可能です：
- 同じ商品を何度でもドラッグ＆ドロップ
- 個数制限なし（箱サイズの範囲内）
- 価格は個数分自動計算
```

**Q5: モバイル端末でも使用できますか？**
```
A5: 基本的には可能ですが制限があります：
- タブレット: 推奨（iPad等）
- スマートフォン: 画面が小さく操作困難
- タッチ操作対応
- 印刷機能は制限あり
```

**Q6: データはどこに保存されますか？**
```
A6: 保存場所は選択した方法により異なります：
- ローカル保存: お客様のPC内
- カスタマーコード: サーバーのデータベース
- 設定情報: ブラウザのローカルストレージ
```

**Q7: 商品の画像を変更できますか？**
```
A7: エンドユーザーは変更できません：
- 商品画像は管理画面で管理
- 店舗スタッフまたは管理者のみ変更可能
- 高品質な商品写真を使用
```

**Q8: 価格が間違っている場合はどうすればよいですか？**
```
A8: 以下の手順で対応してください：
- 店舗スタッフに報告
- 管理画面で価格修正
- システムの再読み込み
- 正確な価格で再計算
```

### 📞 サポート情報

**技術サポート:**
- 店舗スタッフまでお声がけください
- システム管理者: 内線XXX
- 緊急時: メール support@wagashi-sim.com

**営業時間:**
- 平日: 9:00-18:00
- 土日祝: 10:00-17:00

---

## 📊 システム仕様

### 💻 動作環境

**推奨ブラウザ:**
```
Chrome: バージョン90以上
Firefox: バージョン88以上  
Safari: バージョン14以上
Edge: バージョン90以上
```

**システム要件:**
```
OS: Windows 10/11, macOS 10.15+, Linux
メモリ: 4GB以上
ストレージ: 1GB以上の空き容量
ネットワーク: インターネット接続必須
```

**画面解像度:**
```
最小: 1024×768
推奨: 1920×1080以上
モバイル: 768×1024以上（タブレット）
```

### 🔧 技術仕様

**フロントエンド:**
```
Framework: Next.js 15
UI Library: React 19
Styling: Tailwind CSS
Drag & Drop: React DnD
```

**バックエンド:**
```
Runtime: Node.js
Database: MySQL 8.0
ORM: Prisma
Authentication: NextAuth.js
```

**インフラ:**
```
Container: Docker
Reverse Proxy: Nginx
SSL: Let's Encrypt
Monitoring: Prometheus + Grafana
```

---

## 📝 更新履歴

### Version 1.2.0 (2024-01-15)
- ✨ カスタマーコード保存機能追加
- 🎨 印刷レイアウト改善
- 🐛 仕切り自動配置のバグ修正
- 📱 モバイル対応強化

### Version 1.1.0 (2023-12-20)
- ✨ 熨斗機能追加
- 🔄 在庫管理連携
- 🎯 チュートリアル機能追加
- ⚡ パフォーマンス改善

### Version 1.0.0 (2023-11-01)
- 🎉 初回リリース
- 📦 基本的な配置機能
- 💾 保存・読み込み機能
- 🖨️ 印刷機能

---

**和菓子詰め合わせシミュレーター 詳細操作ガイド**  
最終更新: 2024年1月15日  
バージョン: 1.2.0  

© 2024 和菓子シミュレーター開発チーム  
本ドキュメントの無断転載を禁じます。